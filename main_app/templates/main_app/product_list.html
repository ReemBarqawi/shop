    {% extends "base.html" %}

    {% block content %}
    <h1>Product List</h1>

    <!-- Admin: Add New Product -->
    {% if user.is_authenticated and user.is_staff %}
        <a href="{% url 'product_add' %}" class="btn">Add New Product</a>
    {% endif %}

    <div class="product-grid">
        {% for product in products %}
            <div class="product-card">
                <a href="{% url 'product_detail' product.pk %}">
                    {% if product.image %}
                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                    {% endif %}
                    <h3>{{ product.name }}</h3>
                </a>
                <p>Price: ${{ product.price|floatformat:2 }}</p>

                <!-- Admin buttons -->
                {% if user.is_authenticated and user.is_staff %} 
                    <a href="{% url 'product_edit' product.pk %}">Edit</a>
                    <a href="{% url 'product_delete' product.pk %}">Delete</a>
                {% endif %}

                <!-- Customer: Add to Cart (only if logged in and in stock) -->
                {% if user.is_authenticated and not user.is_staff %}
                    {% if product.stock > 0 %}
                        <form action="{% url 'add_to_cart' product.pk %}" method="post">
                            {% csrf_token %}
                            <button type="submit" class="btn">Add to Cart</button>
                        </form>
                    {% else %}
                        <button class="btn disabled" disabled>Out of Stock</button>
                    {% endif %}
                {% endif %}
            </div>
        {% empty %}
            <p>No products available.</p>
        {% endfor %}
    </div>
    {% endblock %}
